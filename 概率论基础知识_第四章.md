- [第4讲  多维随机变量及其分布](#第4讲--多维随机变量及其分布)
  - [知识结构](#知识结构)
    - [判分布](#判分布)
    - [求分布](#求分布)
      - [求联合分布](#求联合分布)
      - [求边缘分布](#求边缘分布)
      - [求条件分布](#求条件分布)
      - [判独立](#判独立)
    - [用分布](#用分布)
  - [一、判分布](#一判分布)
  - [二、求分布](#二求分布)
    - [(1) 求联合分布。](#1-求联合分布)


# 第4讲  多维随机变量及其分布

## 知识结构

### 判分布

$F(x,y)$ 是联合分布函数的充要条件  
1. **单调性**：单调不减函数；  
2. **右连续性**：
$$
\lim_{x\to x_{0}^{+}} F(x,y)=F(x_{0}+0,y)=F(x_{0},y)
$$

$$
\lim_{y\to y_{0}^{+}} F(x,y)=F(x,y_{0}+0)=F(x,y_{0})
$$
1. **有界性**：取值为 $[0,1]$；  
2. **非负性**：$P\{x_1< X\le x_2,\ y_1< Y\le y_2\}\ge 0$.

$\{p_{ij}\}$ 是联合分布的充要条件  
$p_{ij}\ge 0,\quad \sum_{i}\sum_{j} p_{ij}=1$.

$f(x,y)$ 是联合概率密度的充要条件  
$f(x,y)\ge 0,\quad \iint_{-\infty}^{+\infty} f(x,y)\,dxdy =1$.

**反问题**  
① $F(-\infty,y)=0,\ F(x,-\infty)=0$;  
② $F(+\infty,+\infty)=1$, $F(-\infty,-\infty)=0$ 
③ $\sum_{i}\sum_{j} p_{ij}=1$；或 $\iint f(x,y)\,dxdy=1$.

### 求分布

#### 求联合分布

**求$F(X,Y)$**

$(X,Y)\sim p_{ij}$  
$$
F(x,y)=P\{X\le x, Y\le y\}=\sum_{x_i\le x,\; y_j\le y} p_{ij}.
$$

$(X,Y)\sim f(x,y)$  
$$
F(x,y)=P\{X\le x, Y\le y\}=\int_{-\infty}^{x}\!\left[\int_{-\infty}^{y} f(u,v)\,dv\right]du.
$$

**求$p_{ij}(常与求P(A)结合)$**

**求$f(X,Y)$**

**二维均匀分布**  
$$
f(x,y)=
\begin{cases}
\dfrac{1}{S_D}, & (x,y)\in D,\\
0, & \text{其他},
\end{cases}
\qquad S_D \text{ 为区域 } D \text{ 的面积}.
$$

**二维正态分布**  
$$
f(x,y)=\frac{1}{2\pi\sigma_{1}\sigma_{2}\sqrt{1-\rho^{2}}}
\exp\!\left\{
-\frac{1}{2(1-\rho^{2})}
\left[
\left(\frac{x-\mu_{1}}{\sigma_{1}}\right)^{2}
-2\rho\left(\frac{x-\mu_{1}}{\sigma_{1}}\right)\left(\frac{y-\mu_{2}}{\sigma_{2}}\right)
+\left(\frac{y-\mu_{2}}{\sigma_{2}}\right)^{2}
\right]
\right\},
$$
$$
\mu_{1}\in \mathbb{R},\ \mu_{2}\in \mathbb{R},\ \sigma_{1}>0,\ \sigma_{2}>0,\ -1<\rho<1.
$$


#### 求边缘分布  
**求 $F_X(x), F_Y(y)$**
$$
F_X(x)=F(x,+\infty),\qquad F_Y(y)=F(+\infty,y)
$$

**求 $p_{i\cdot}, p_{\cdot j}$**
$$
p_{i\cdot}=\sum_{j} p_{ij},\qquad p_{\cdot j}=\sum_{i} p_{ij}
$$

**求 $f_X(x), f_Y(y)$**
$$
f_X(x)=\int_{-\infty}^{+\infty} f(x,y)\,dy,\qquad
f_Y(y)=\int_{-\infty}^{+\infty} f(x,y)\,dx
$$

#### 求条件分布 
**求** $P\{Y = y_j \mid X = x_i\},\ P\{X = x_i \mid Y = y_j\}$

$$
P\{Y = y_j \mid X = x_i\} = \frac{P\{X = x_i, Y = y_j\}}{P\{X = x_i\}} = \frac{p_{ij}}{p_{i\cdot}},
$$
$$
P\{X = x_i \mid Y = y_j\} = \frac{P\{X = x_i, Y = y_j\}}{P\{Y = y_j\}} = \frac{p_{ij}}{p_{\cdot j}}.
$$

**求** $f_{Y|X}(y|x),\ f_{X|Y}(x|y)$

$$
f_{Y|X}(y|x)=\frac{f(x,y)}{f_X(x)},\qquad
f_{X|Y}(x|y)=\frac{f(x,y)}{f_Y(y)}.
$$

#### 判独立 
① 对任意 $x,y$, $F(x,y)=F_X(x)\cdot F_Y(y)$

② 对任意 $i,j$, $p_{ij}=p_i\cdot p_j$

③ 联合分布律的每行元素对应成比例

④ 对任意 $x,y$, $f(x,y)=f_X(x)f_Y(y)$

⑤ 若 $f(x,y)$ 的非零区域是矩形，且 $f(x,y)$ 能分解成仅含 $x,y$ 的两个一元函数的乘积，则 $X$ 与 $Y$ 独立。

⑥ 若 $X_1,X_2,\dots,X_n$ 相互独立，则其任意 $k$ 个随机变量也相互独立，且其函数 $g_1(X_1),g_2(X_2),\dots,g_n(X_n)$ 也相互独立 


### 用分布

① $(X,Y)\sim p_{ij}$，则 $P\{(X,Y)\in D\}=\sum_{(x_i,y_j)\in D} p_{ij}$

② $(X,Y)\sim f(x,y)$，则 $P\{(X,Y)\in D\}=\iint_{D} f(x,y)\,dx\,dy$

③ $(X,Y)$ 为混合型，则用全概率公式

④ 反问题：已知概率反求参数

## 一、判分布

对任意的实数 $x,y$，称二元函数  
$$
F(x,y)=P\{X\le x,\,Y\le y\}
$$
为二维随机变量 $(X,Y)$ 的分布函数，记为 $(X,Y)\sim F(x,y)$。$F(x,y)$ 是事件 $\{X\le x\text{ 与 }Y\le y\}$ 同时发生的概率。

(1) $F(x,y)$ 是联合分布函数的充要条件：  
① 单调性  $F(x,y)$ 是 $x,y$ 的单调不减函数；当 $x_1<x_2$ 时，$F(x_1,y)\le F(x_2,y)$；当 $y_1<y_2$ 时，$F(x,y_1)\le F(x,y_2)$。  
② 右连续性  $F(x,y)$ 是 $x,y$ 的右连续函数：  
$$
\lim_{x\to x_0^{+}}F(x,y)=F(x_0+0,y)=F(x_0,y),\qquad
\lim_{y\to y_0^{+}}F(x,y)=F(x,y_0+0)=F(x,y_0).
$$
③ 有界性  $F(-\infty,y)=F(x,-\infty)=F(-\infty,-\infty)=0,\; F(+\infty,+\infty)=1$。  
④ 非负性  对任意 $x_1<x_2,\; y_1<y_2$，有  
$$
P\{x_1< X\le x_2,\; y_1< Y\le y_2\}=F(x_2,y_2)-F(x_1,y_2)-F(x_2,y_1)+F(x_1,y_1)\ge 0.
$$

(2) $\{p_{ij}\}$ 是联合分布律的充要条件：  
如果二维离散型随机变量 $(X,Y)$ 只能取得有限或可列取值对 $(x_1,y_1),(x_2,y_2),\dots,(x_n,y_n),\dots$，则称 $(X,Y)$ 为二维离散型随机变量。称  
$$
p_{ij}=P\{X=x_i,\,Y=y_j\},\quad i,j=1,2,\dots
$$
为 $(X,Y)$ 的分布律或 $X$ 与 $Y$ 的联合分布律，记为 $(X,Y)\sim p_{ij}$。联合分布律常用表格形式表示：

| $X\backslash Y$ | $y_1$ | $y_2$ | $y_j$ | $\cdots$ | $P\{X=x_i\}$ |
|------------------|--------|--------|--------|-----------|---------------|
| $x_1$ | $p_{11}$ | $p_{12}$ | $p_{1j}$ | $\cdots$ | $p_{1\cdot}$ |
| $x_i$ | $p_{i1}$ | $p_{i2}$ | $p_{ij}$ | $\cdots$ | $p_{i\cdot}$ |
| $\vdots$ | $\vdots$ | $\vdots$ | $\vdots$ |  | $\vdots$ |
| $x_n$ | $p_{n1}$ | $p_{n2}$ | $p_{nj}$ | $\cdots$ | $p_{n\cdot}$ |
| $P\{Y=y_j\}$ | $p_{\cdot 1}$ | $p_{\cdot 2}$ | $p_{\cdot j}$ | $\cdots$ | $1$ |

$\{p_{ij}\}$ 是联合分布律的充要条件为 $p_{ij}\ge 0$ 且 $\sum_i\sum_j p_{ij}=1$。

(3) $f(x,y)$ 是联合概率密度的充要条件：  
如果二维随机变量 $(X,Y)$ 的分布函数 $F(x,y)$ 可表示为  
$$
F(x,y)=\int_{-\infty}^{y}\!\!\int_{-\infty}^{x} f(u,v)\,du\,dv,\quad (x,y)\in \mathbb{R}^2,
$$
其中 $f(x,y)$ 是非负可积函数，则称 $(X,Y)$ 为**二维连续型随机变量**，称 $f(x,y)$ 为 $(X,Y)$ 的**概率密度**，记为 $(X,Y)\sim f(x,y)$。  
$f(x,y)$ 是联合概率密度的充要条件为 $f(x,y)\ge 0$ 且
$$
\iint_{-\infty}^{+\infty} f(x,y)\,dx\,dy=1.
$$

(4) **反问题（重点）**：  
用
① $F(-\infty,y)=0,\ F(x,-\infty)=0$;  
② $F(+\infty,-\infty)=0,\ F(+\infty,+\infty)=1$;  
③ $\sum_i\sum_j p_{ij}=1;\int_{-\infty}^{+\infty}\!\!\int_{-\infty}^{+\infty} f(x,y)\,dx\,dy=1$。  
建方程，求参数

## 二、求分布

### (1) 求联合分布。  
① 求 $F(x,y)$。

a. $(X,Y)\sim p_{ij}$，则  
$$
F(x,y)=P\{X\le x,\;Y\le y\}=\sum_{x_i\le x,\;y_j\le y} p_{ij}.
$$

b. $(X,Y)\sim f(x,y)$，则  
$$
F(x,y)=P\{X\le x,\;Y\le y\}=\int_{-\infty}^{x}\!\left[\int_{-\infty}^{y} f(u,v)\,dv\right]du.
$$

② 求 $p_{ij}$（常与求 $P(A)$ 结合）。

③ 求 $f(x,y)$。  
a. **二维均匀分布**  
称 $(X,Y)$ 在平面有界区域 $D$ 上服从**均匀分布**，如果 $(X,Y)$ 的概率密度为  
$$
f(x,y)=
\begin{cases}
\dfrac{1}{S_D}, & (x,y)\in D,\\
0, & \text{其他},
\end{cases}
$$
其中 $S_D$ 为区域 $D$ 的面积。

b. **二维正态分布**  
如果 $(X,Y)$ 的概率密度为
$$
f(x,y)=\frac{1}{2\pi\sigma_{1}\sigma_{2}\sqrt{1-\rho^{2}}}
\exp\!\left\{
-\frac{1}{2(1-\rho^{2})}
\left[
\left(\frac{x-\mu_{1}}{\sigma_{1}}\right)^{2}
-2\rho\left(\frac{x-\mu_{1}}{\sigma_{1}}\right)\left(\frac{y-\mu_{2}}{\sigma_{2}}\right)
+\left(\frac{y-\mu_{2}}{\sigma_{2}}\right)^{2}
\right]
\right\},
$$
其中 $\mu_{1}\in\mathbb{R},\ \mu_{2}\in\mathbb{R},\ \sigma_{1}>0,\ \sigma_{2}>0,\ -1<\rho<1$，则称 $(X,Y)$ 服从参数为 $\mu_{1},\mu_{2},\sigma_{1}^{2},\sigma_{2}^{2},\rho$ 的二维正态分布，记为  
$$
(X,Y)\sim N(\mu_{1},\mu_{2};\sigma_{1}^{2},\sigma_{2}^{2};\rho).
$$

**[注] 有下面6条重要结论：**  
① 若 $(X_{1},X_{2})\sim N(\mu_{1},\mu_{2};\sigma_{1}^{2},\sigma_{2}^{2};\rho)$，则 $X_{1}\sim N(\mu_{1},\sigma_{1}^{2})$，$X_{2}\sim N(\mu_{2},\sigma_{2}^{2})$。  
② 若 $X_{1}\sim N(\mu_{1},\sigma_{1}^{2})$, $X_{2}\sim N(\mu_{2},\sigma_{2}^{2})$，且 $X_{1},X_{2}$ 相互独立，则 $(X_{1},X_{2})\sim N(\mu_{1},\mu_{2};\sigma_{1}^{2},\sigma_{2}^{2};0)$。  
③ $(X_1,X_2)\sim N \Rightarrow k_1X_1+k_2X_2\sim N$ （$k_1,k_2$ 是不全为 0 的常数）。
④ $(X_1,X_2)\sim N$，$Y_1=a_1X_1+a_2X_2$，$Y_2=b_1X_1+b_2X_2$，且  
$$
\left|\begin{matrix} a_1 & a_2 \\ b_1 & b_2 \end{matrix}\right|\ne 0 \;\Rightarrow\; (Y_1,Y_2)\sim N.
$$  

⑤ $(X_1,X_2)\sim N$，则 $X_1, X_2$ 相互独立 $\Longleftrightarrow$ $X_1, X_2$ 不相关。  
以上 5 条可推广至有限个随机变量的情形。
⑥ $(X,Y)\sim N$，则 $f_{X|Y}(x|y)\sim N$，$f_{Y|X}(y|x)\sim N$ （二维正态分布的条件分布仍是正态分布）。

(2) 求边缘分布：  
① 求 $F_X(x), F_Y(y)$: $F_X(x)=F(x,+\infty),\quad F_Y(y)=F(+\infty,y)$。  
② 求 $p_{i\cdot}, p_{\cdot j}$。 
$$p_{i\cdot}=\sum_{j}p_{ij},\quad p_{\cdot j}=\sum_{i}p_{ij}$$

③ 求 $f_X(x),\,f_Y(y)$.
$$
f_X(x)=\int_{-\infty}^{+\infty} f(x,y)\,dy,\qquad
f_Y(y)=\int_{-\infty}^{+\infty} f(x,y)\,dx
$$

(3) 求条件分布:  
① 求 $P\{Y=y_j\mid X=x_i\},\; P\{X=x_i\mid Y=y_j\}$
$$
P\{Y=y_j\mid X=x_i\}=\frac{P\{X=x_i,Y=y_j\}}{P\{X=x_i\}}=\frac{p_{ij}}{p_{i\cdot}},\qquad
P\{X=x_i\mid Y=y_j\}=\frac{P\{X=x_i,Y=y_j\}}{P\{Y=y_j\}}=\frac{p_{ij}}{p_{\cdot j}}
$$

② 求 $f_{Y|X}(y|x),\, f_{X|Y}(x|y)$
$$
f_{Y|X}(y|x)=\frac{f(x,y)}{f_X(x)},\qquad
f_{X|Y}(x|y)=\frac{f(x,y)}{f_Y(y)}
$$

(4) 判独立。  
① $X$ 与 $Y$ 相互独立 $\Longleftrightarrow$ 对任意 $x,y$, $F(x,y)=F_X(x)\cdot F_Y(y)$。  
$X,Y$ 不独立 $\Longleftrightarrow$ 存在 $x_0,y_0$，使 $A=\{X\le x_0\}$ 与 $B=\{Y\le y_0\}$ 不独立，即 $F(x_0,y_0)\ne F_X(x_0)\cdot F_Y(y_0)$。  
因此，证明不独立的常用方法：找 $x_0,y_0$，使 $0< P\{X\le x_0\},\ P\{Y\le y_0\} <1$，  
$\{X\le x_0\}\subset \{Y\le y_0\}$ 或 $\{Y\le y_0\}\subset \{X\le x_0\}$ 或 $\{X\le x_0,\ Y\le y_0\}=\varnothing$。

② 若 $(X,Y)$ 为二维离散型随机变量，$X$ 与 $Y$ 相互独立 $\Longleftrightarrow$ 对任意 $i,j$，$p_{ij}=p_{i\cdot}\,p_{\cdot j}$。

③ 由②知，$(X,Y)$ 的分布律为  

| $X \backslash Y$ | $y_1$ | $y_2$ | $y_3$ | $p_{i\cdot}$ |
|-------------------|--------|--------|--------|---------------|
| $x_1$           | $p_{11}$ | $p_{12}$ | $p_{13}$ | $p_{1\cdot}$ |
| $x_2$           | $p_{21}$ | $p_{22}$ | $p_{23}$ | $p_{2\cdot}$ |
| $p_{\cdot j}$   | $p_{\cdot 1}$ | $p_{\cdot 2}$ | $p_{\cdot 3}$ | $1$ |


其中 $p_{ij}\neq 0,\ i=1,2,\ j=1,2,3,$ 且满足
$$\begin{bmatrix} p_{1\cdot} \\ p_{2\cdot} \end{bmatrix}\begin{bmatrix} p_{\cdot 1} & p_{\cdot 2} & p_{\cdot 3} \end{bmatrix}=\begin{bmatrix} p_{11} & p_{12} & p_{13} \\ p_{21} & p_{22} & p_{23} \end{bmatrix}$$



即
$$
\frac{p_{11}}{p_{21}}=\frac{p_{12}}{p_{22}}=\frac{p_{13}}{p_{23}}.
$$

又以上过程可逆，故有重要结论：当 $p_{ij}\neq 0$ 时，$X,Y$ 独立 $\Longleftrightarrow$ 联合分布律的每行元素对应成比例。故可由联合分布律的每行元素是否对应成比例来判断 $X,Y$ 是否独立。

④ 若 $(X,Y)$ 为二维连续型随机变量，$X$ 与 $Y$ 相互独立 $\Longleftrightarrow$ 对任意 $x,y$, $f(x,y)=f_X(x)f_Y(y)$。

⑤ a. 若 $f(x,y)$ 的非零区域不是矩形（包括无界广义矩形），则 $X$ 与 $Y$ 不独立。  
b. 若 $f(x,y)$ 不能分解成仅含 $x,y$ 的两个一元函数的乘积，则 $X$ 与 $Y$ 不独立。  
c. 若 $f(x,y)$ 的非零区域是矩形，且 $f(x,y)$ 能分解成仅含 $x,y$ 的两个一元函数的乘积，则 $X$ 与 $Y$ 独立。  

⑥ a. 若 $X_1,X_2,\dots,X_n$ 相互独立，则其中任意 $k(2\le k\le n)$ 个随机变量也相互独立。  
b. 若 $X_1,X_2,\dots,X_n$ 相互独立，则其函数 $g_1(X_1),g_2(X_2),\dots,g_n(X_n)$ 也相互独立。  

**三 用分布**

用分布求概率及反问题：  

① $(X,Y)\sim p_{ij}$，则 $P\{(X,Y)\in D\}=\sum_{(x_i,y_j)\in D} p_{ij}$。  

② $(X,Y)\sim f(x,y)$，则 $P\{(X,Y)\in D\}=\iint_{D} f(x,y)\,dx\,dy$。  

③ $(X,Y)$ 为混合型，则用全概率公式。  

④ 反问题：已知概率反求参数。  
