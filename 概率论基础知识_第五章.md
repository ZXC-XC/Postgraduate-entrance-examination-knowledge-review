- [第5讲  多维随机变量函数的分布](#第5讲--多维随机变量函数的分布)
  - [知识结构](#知识结构)
    - [多维 → 一维](#多维--一维)
      - [（离散型，离散型）→ 离散型](#离散型离散型-离散型)
      - [（连续型，连续型）→ 连续型](#连续型连续型-连续型)
      - [（离散型，连续型）→ 连续型](#离散型连续型-连续型)
    - [一维 → 多维](#一维--多维)
      - [(离散型 → (离散型, 离散型))](#离散型--离散型-离散型)
      - [(连续型 → (离散型, 离散型))](#连续型--离散型-离散型)
    - [多维 → 多维](#多维--多维)
      - [((离散型, 离散型) → (离散型, 离散型))](#离散型-离散型--离散型-离散型)
      - [((连续型, 连续型) → (离散型, 离散型))](#连续型-连续型--离散型-离散型)
      - [((离散型, 连续型) → (离散型, 离散型))](#离散型-连续型--离散型-离散型)
  - [一、多维→一维](#一多维一维)
    - [(1) 分布函数法：](#1-分布函数法)
    - [(2) 卷积分公式法：](#2-卷积分公式法)
    - [(3) (离散型, 连续型) → 连续型](#3-离散型-连续型--连续型)
  - [二、一维 → 多维](#二一维--多维)
  - [三、多维 → 多维](#三多维--多维)


# 第5讲  多维随机变量函数的分布

## 知识结构

### 多维 → 一维

#### （离散型，离散型）→ 离散型  

$(X,Y)\sim p_{ij}, Z=g(X,Y)\Rightarrow Z$ 的分布律  
$$
\begin{cases}
Z = X+Y\\
Z = XY\\
Z = \max\{X,Y\}\\
Z = \min\{X,Y\}
\end{cases}
\text{ 的分布律}
$$

#### （连续型，连续型）→ 连续型
**分布函数法**  
$$
F_Z(z)=P\{g(X,Y)\le z\}=\iint_{g(x,y)\le z} f(x,y)\,dx\,dy
$$

**卷积公式法**  

**Z = X + Y ⇒**  
$$
f_Z(z)=\int_{-\infty}^{+\infty} f(x,\, z-x)\,dx
= \int_{-\infty}^{+\infty} f(z-y,\, y)\,dy
= \textbf{(独立)} \int_{-\infty}^{+\infty} f_X(x) f_Y(z-x)\,dx
= \int_{-\infty}^{+\infty} f_X(z-y) f_Y(y)\,dy
$$

**Z = X - Y ⇒**  
$$
f_Z(z)=\int_{-\infty}^{+\infty} f(x,\, x-z)\,dx
= \int_{-\infty}^{+\infty} f(y+z,\, y)\,dy
= \textbf{(独立)} \int_{-\infty}^{+\infty} f_X(x) f_Y(x-z)\,dx
= \int_{-\infty}^{+\infty} f_X(y+z) f_Y(y)\,dy
$$

**Z = X Y ⇒**  
$$
f_Z(z)=\int_{-\infty}^{+\infty} \frac{1}{|x|} f\!\left(x,\, \frac{z}{x}\right) dx
= \int_{-\infty}^{+\infty} \frac{1}{|y|} f\!\left(\frac{z}{y},\, y\right) dy
= \textbf{(独立)} \int_{-\infty}^{+\infty} \frac{1}{|x|} f_X(x) f_Y\!\left(\frac{z}{x}\right) dx
= \int_{-\infty}^{+\infty} \frac{1}{|y|} f_X\!\left(\frac{z}{y}\right) f_Y(y)\,dy
$$

**Z = $\dfrac{X}{Y}$ ⇒**  
$$
f_Z(z)=\int_{-\infty}^{+\infty} |y|\, f(yz,\, y)\,dy
= \textbf{(独立)} \int_{-\infty}^{+\infty} |y|\, f_X(yz) f_Y(y)\,dy
$$


**最值分布**  
$P\{\max\{X,Y\}\le z\}=P\{X\le z,\,Y\le z\}=F(z,z)$

$P\{\min\{X,Y\}\le z\}=F_X(z)+F_Y(z)-F(z,z)$

#### （离散型，连续型）→ 连续型
$X\sim p_i,\ Y\sim f(y|X),\ Z=g(X,Y)$.

### 一维 → 多维

#### (离散型 → (离散型, 离散型))  
$X \sim p_x,\quad \begin{cases} U = g(X) \\ V = h(X) \end{cases} \Rightarrow (U,V)\sim q_{ij}$

#### (连续型 → (离散型, 离散型))  
$X \sim f(x),\quad \begin{cases} U = g(X) \\ V = h(X) \end{cases} \Rightarrow (U,V)\sim p _{ij}$

### 多维 → 多维

#### ((离散型, 离散型) → (离散型, 离散型)) 
$(X,Y)\sim p_{ij},\quad \begin{cases} U = g(X,Y) \\ V = h(X,Y) \end{cases} \Rightarrow (U,V)\sim q_{ij}$

#### ((连续型, 连续型) → (离散型, 离散型))
$(X,Y)\sim f(x,y),\quad \begin{cases} U = g(X,Y) \\ V = h(X,Y) \end{cases} \Rightarrow (U,V)\sim p_{ij}$

#### ((离散型, 连续型) → (离散型, 离散型))  
$X \sim p_i,\; Y \sim f_Y(y),\quad \begin{cases} U = g(X,Y) \\ V = h(X,Y) \end{cases} \Rightarrow (U,V)\sim q_{ij}$

## 一、多维→一维

**(1) (离散型, 离散型) → 离散型**

**①** $(X,Y)\sim p_{ij},\; Z = g(X,Y) \Rightarrow Z \sim q$.

**②** $X \sim p_i,\; Y \sim q_j$, $X,Y$ 独立且取值在某一集合，可考虑 $Z = X+Y,\; XY,\; \max\{X,Y\},\; \min\{X,Y\}$ 等， 这是重点。

**(2) (连续型, 连续型) → 连续型**

### (1) 分布函数法： 
设 $(X,Y)\sim f(x,y),\; Z = g(X,Y)$，则  
$$
F_Z(z)=P\{g(X,Y)\le z\}=\iint_{g(x,y)\le z} f(x,y)\,dx\,dy,
\qquad
f_Z(z)=F_Z'(z).
$$

### (2) 卷积分公式法：

**a. 和的分布：**  
设 $(X,Y)\sim f(x,y)$，则 $Z = X+Y$ 的概率密度为  
$$
f_Z(z)=\int_{-\infty}^{+\infty} f(x, z-x)\,dx
= \int_{-\infty}^{+\infty} f(z-y, y)\,dy
$$
**独立：**  
$$
f_Z(z)=\int_{-\infty}^{+\infty} f_X(x) f_Y(z-x)\,dx
= \int_{-\infty}^{+\infty} f_X(z-y) f_Y(y)\,dy.
$$

**b. 差的分布：**  
设 $(X,Y)\sim f(x,y)$，则 $Z = X - Y$ 的概率密度为  
$$
f_Z(z)=\int_{-\infty}^{+\infty} f(x, x-z)\,dx
= \int_{-\infty}^{+\infty} f(y+z, y)\,dy
$$
**独立：**  
$$
f_Z(z)=\int_{-\infty}^{+\infty} f_X(x) f_Y(x-z)\,dx
= \int_{-\infty}^{+\infty} f_X(y+z) f_Y(y)\,dy.
$$

**c. 积的分布：**  
设 $(X,Y)\sim f(x,y)$，则 $Z = XY$ 的概率密度为  
$$
f_Z(z)=\int_{-\infty}^{+\infty} \frac{1}{|x|} f\!\left(x, \frac{z}{x}\right) dx
= \int_{-\infty}^{+\infty} \frac{1}{|y|} f\!\left(\frac{z}{y}, y\right) dy
$$
**独立：**  
$$
f_Z(z)=\int_{-\infty}^{+\infty} \frac{1}{|x|} f_X(x) f_Y\!\left(\frac{z}{x}\right) dx
= \int_{-\infty}^{+\infty} \frac{1}{|y|} f_X\!\left(\frac{z}{y}\right) f_Y(y)\,dy.
$$

**d. 商的分布：**  
设 $(X,Y)\sim f(x,y)$，则 $Z = \dfrac{X}{Y}$ 的概率密度为  
$$
f_Z(z)=\int_{-\infty}^{+\infty} |y|\, f(yz, y)\,dy
$$
**独立：**  
$$
f_Z(z)=\int_{-\infty}^{+\infty} |y|\, f_X(yz) f_Y(y)\,dy.
$$

**[注]** 以上所述的四组公式，可用“口诀”来记忆：**“和积不换谁，换完求偏导”**。  
如 $Z = X - Y$ 时 $f_Z(z)=\int_{-\infty}^{+\infty} f(x, x - z)\,dx$ 中。
先用第一句：“积谁不换谁”，对 x 积分，则不换 x，写成 $f(x, \square)$，换 $y = x - z$，为 $f(x, x - z)$。
再用第二句：“换完求偏导”。 $\dfrac{\partial (x - z)}{\partial z} = -1$，因概率密度非负，要加绝对值，即 $|-1| = 1$。这样便记住了公式。**  


**③ 极值函数的分布**

**a. $\max\{X,Y\}$ 分布**  
设 $(X,Y)\sim f(x,y)$，则 $Z = \max\{X,Y\}$ 的分布函数为  
$$
F_{\max}(z)=P\{\max\{X,Y\}\le z\}=P\{X\le z,\,Y\le z\}=F(z,z).
$$
当 $X$ 与 $Y$ 独立时，  
$$
F_{\max}(z)=F_X(z)\,F_Y(z).
$$

**b. $\min\{X,Y\}$ 分布**  
设 $(X,Y)\sim f(x,y)$，则 $Z = \min\{X,Y\}$ 的分布函数为  
$$
\begin{aligned}
F_{\min}(z)&=P\{\min\{X,Y\}\le z\}=P(\{X\le z\}\cup\{Y\le z\})\\
&=P(X\le z)+P(Y\le z)-P(X\le z, Y\le z)\\
&=F_X(z)+F_Y(z)-F(z,z).
\end{aligned}
$$
当 $X$ 与 $Y$ 独立时，  
$$
F_{\min}(z)=F_X(z)+F_Y(z)-F_X(z)F_Y(z)=1-[1-F_X(z)][1-F_Y(z)].
$$

推广到 $n$ 个相互独立的随机变量 $X_1, X_2,\dots, X_n$ 的情况  
$$
F_{\max}(z)=F_{X_1}(z) F_{X_2}(z)\cdots F_{X_n}(z),
$$
$$
F_{\min}(z)=1-\bigl[1-F_{X_1}(z)\bigr]\bigl[1-F_{X_2}(z)\bigr]\cdots\bigl[1-F_{X_n}(z)\bigr].
$$

特别地，当 $X_i (i=1,2,\dots,n)$ 相互独立且同分布（分布函数 $F(x)$ 与密度 $f(x)$）时： 
$$
F_{\max}(z) = [F(z)]^{n},\qquad f_{\max}(z)= n[F(z)]^{\,n-1} f(z),
$$
$$
F_{\min}(z) = 1-[1-F(z)]^{n},\qquad f_{\min}(z)= n[1-F(z)]^{\,n-1} f(z).
$$

这些结果在数理统计计算分布时较为重要。
### (3) (离散型, 连续型) → 连续型

设 $X \sim p_i,\; Y \sim f_y(y),\; Z = g(X,Y)$（常考 $X \pm Y,\; XY$ 等），则  

**①** $X, Y$ 独立时，可用分布函数法及全概率公式求 $F_Z(z)$。  

**②** $X, Y$ 不独立时，用分布函数法。 

## 二、一维 → 多维

**(离散型 → (离散型, 离散型))**  
$X \sim p_i,\quad \begin{cases} U = g(X) \\ V = h(X) \end{cases} \Rightarrow (U,V)\sim q_{ij}$

**(连续型 → (离散型, 离散型))**  
$X \sim f(x),\quad \begin{cases} U = g(X) \\ V = h(X) \end{cases} \Rightarrow (U,V)\sim p_{ij}$

## 三、多维 → 多维

**((离散型, 离散型) → (离散型, 离散型))**  
$(X,Y)\sim p_{ij},\quad \begin{cases} U = g(X,Y) \\ V = h(X,Y) \end{cases} \Rightarrow (U,V)\sim q_{ij}$

**((连续型, 连续型) → (离散型, 离散型))**  
$(X,Y)\sim f(x,y),\quad \begin{cases} U = g(X,Y) \\ V = h(X,Y) \end{cases} \Rightarrow (U,V)\sim p_{ij}$

**((离散型, 连续型) → (离散型, 离散型))**  
$X \sim p_i,\; Y \sim f_Y(y),\quad \begin{cases} U = g(X,Y) \\ V = h(X,Y) \end{cases} \Rightarrow (U,V)\sim q_{ij}$